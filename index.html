<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Filtering Algorithms for Stochastic Biochemical Reaction Networks</title>
<link href="BlogPostAssets/styles/blogPostStyle.css" rel="stylesheet" type="text/css">
<!--The following script tag downloads a font from the Adobe Edge Web Fonts server for use within the web page. We recommend that you do not modify it.--><script>var __adobewebfontsappname__="dreamweaver"</script><script src="http://use.edgefonts.net/montserrat:n4:default;source-sans-pro:n2:default.js" type="text/javascript"></script>
</head>

<body>
<div id="mainwrapper">
<img src="figures/eth_logo.png" height="46.1" alt=""/>
	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <a href="https://bsse.ethz.ch/ctsb" target="_blank"><img src="figures/ctsb.gif" width="150.4" height="46.1" alt=""></a> <img src="figures/SNF_logo_standard_office_color_pos_e.png" height="46.1" alt="" style="float: right;"/>
	
	
  <div id="content">
    <div class="notOnDesktop"> 
      <!-- This search box is displayed only in mobile and tablet laouts and not in desktop layouts -->
      <input type="text" placeholder="Search">
    </div>
    <section id="mainContent"> 
      <!--************************************************************************
    Main Blog content starts here
    ****************************************************************************-->
      <h1>
        <!-- Blog title -->
Filtering Algorithms for Stochastic Biochemical Reaction Networks Developed in the CTSB Lab, at ETH Zurich</h1>
      <h3>
        <!-- Tagline -->Sponsored by SNSF under grant 182653.</h3>
      <p>This webpage lists several stochastic filtering algorithms developed in the CTSB (Control Theory and Systems Biology) Lab at ETH Zurich, for intracellular reaction systems. These works were sponsored by the SNSF (Swiss National Science Foundation) under the grant 182653. We sincerely appreciate the SNSF for its generous support and Swiss taxpayers for their invaluable contribution in advancing scientific research and development. </p>
	
	<div id="filtering">
	<h2>What is stochastic filtering for intracellular reaction processes </h2>
		<p> With modern time-lapse microscopes, scientists can measure the time trajectory of some intracellular species (e.g., fluorescent reporters) and use these measurements to investigate biological phenomena in living cells. 
		Despite these successes, this technology can only measure a few species in the cell due to the limited availability of orthogonal fluorescent reporters, which poses a big challenge in understanding and regulating intracellular biological processes.
		To tackle this issue, scientists need to solve a stochastic filtering problem for intracellular reaction processes, i.e., to infer the dynamics of the hidden chemical species from the measured fluorescent readouts.
		</p>
		<img src="figures/filtering.png" alt="" width="500", style="display: flex; justify-content: center; align-items: center;">
	</div>
	
	<div id="project1">
    <h2>Project 1: Bootstrap particle filtering utilizing time-scale separation [<a href="https://www.sciencedirect.com/science/article/pii/S0021999122005034" target="_blank"><small>Paper</small></a>, &nbsp; <a href="https://github.com/ZhouFang92/Particle-filters-for-multi-scale-CRNs-v.1" target="_blank"> <small>Code</small></a>]</h2>
      <p>A straightforward approach to this filtering problem is to use a particle filter where particles are generated by simulation of the full model and weighted according to observations. However, the exact simulation of the full dynamic model usually takes an impractical amount of computational time and prevents this type of particle filters from being used for real-time applications, such as transcription regulation networks. Inspired by the recent development of hybrid approximations to multiscale chemical reaction networks, we approach the filtering problem in an alternative way. We first prove that accurate solutions to the filtering problem can be constructed by solving the filtering problem for a reduced model that represents the dynamics as a hybrid process. The model reduction is based on exploiting the time-scale separations in the original network and, therefore, can greatly reduce the computational effort required to simulate the dynamics. As a result, we are able to develop efficient particle filters to solve the filtering problem for the original model by applying particle filters to the reduced model. We illustrate the accuracy and the computational efficiency of our approach using several numerical examples. </p>
	  <ul>
		  <p>Z. Fang, A. Gupta, and M. Khammash. "Stochastic filtering for multiscale stochastic reaction networks based on hybrid approximations." Journal of Computational Physics 467 (2022): 111441.</p>
	    <p>GitHub: https://github.com/ZhouFang92/Particle-filters-for-multi-scale-CRNs-v.1</p>
      </ul>
	</div>
		
	<div id="project2">
	<h2>Project 2: Regularized particle filtering algorithms 
		[<a href="https://epubs.siam.org/doi/full/10.1137/21M1453025?casa_token=ENJ8aRIWYBkAAAAA%3AH5zTw_yeeSHn8tOfMbjhBvb4_ZS7Nzum1gjKkhFdK-t2xMx0vMqM-NYMiMufk3xAN4ROXLPA" target="_blank"><small>Paper</small></a>, &nbsp;<a href="https://github.com/ZhouFang92/Regularized-particle-filter-for-stochastic-reaction-networks"  target="_blank"><small>Code</small></a>]</h2>
      <p>Usually, the model parameters need to be inferred simultaneously with state variables, and a conventional particle filter can fail to solve this problem accurately due to sample degeneracy. In this case, the regularized particle filter (RPF) is preferred to the conventional ones, as the RPF can mitigate sample degeneracy by perturbing particles with artificial noise. However, the artificial noise introduces an additional bias to the estimate, and, thus, it is questionable whether the RPF can provide reliable results for SRNs. In this paper, we aim to identify conditions under which the RPF converges to the exact filter in the filtering problem determined by a bimolecular network. First, we establish computationally efficient RPFs for SRNs on different scales using different dynamical models, including the continuous-time Markov process, tau-leaping model, and piecewise deterministic process. Then, by parameter sensitivity analyses, we show that the established RPFs converge to the exact filters if all reactions leading to an increase of the molecular population have linearly growing propensities and some other mild conditions are satisfied simultaneously. This ensures the performance of the RPF for a large class of SRNs, and several numerical examples are presented to illustrate our results. </p>
		<ul>
		  <p>Z. Fang, A. Gupta, and M. Khammash. "Convergence of regularized particle filters for stochastic reaction networks." SIAM Journal on Numerical Analysis, 2023</p>
	    <p>GitHub: https://github.com/ZhouFang92/Regularized-particle-filter-for-stochastic-reaction-networks</p>
      </ul>
	</div>
		
	<div id="project3">
	<h2>Project 3: Finite state projection method for continuous-time noise-free observations 
		[<a href="https://www.biorxiv.org/content/10.1101/2022.10.18.512737v1" target="_blank"><small>Paper</small></a>,&nbsp; <a href="https://github.com/EleSofi/FFSP_project"  target="_blank"> <small>Code</small></a>]
		</h2>
      <p>Here we develop a finite-dimensional filter for estimating the conditional distribution of the hidden (unobserved) species given continuous-time and noise-free observations of some species (e.g. a fluorescent reporter). It was proposed that in this setting, the conditional distribution evolves in time according to a large or potentially infinite-dimensional system of coupled ordinary differential equations with jumps, known as the filtering equation. We first formally verify the validity of this filtering equation under the non-explosivity condition and then develop a Finite-State Projection method, which provides an approximate solution by truncating the infinite-dimensional system. Additionally, we give computable error bounds for the algorithm. Finally, we present several numerical examples to illustrate our method and compare its performance with an existing particle filtering method for estimating the conditional distribution. </p>
		<ul>
		  <p>E. S. D’Ambrosio, Z. Fang, A. Gupta, M. Khammash, “Filtered finite state projection method for the analysis and estimation of stochastic biochemical reaction networks", bioRxiv.</p>
	    <p>GitHub: https://github.com/EleSofi/FFSP_project</p>
      </ul>
	</div>
		
		
	<div id="project4">
	<h2>Project 4: Divide-and-conquer approach [<a href="https://www.biorxiv.org/content/10.1101/2022.10.28.514278v2" target="_blank"><small>Paper</small></a>,&nbsp; <a href="https://github.com/ZhouFang92/Rao-Blackwellized-CME-solver"  target="_blank"> <small>Code1</small></a>,&nbsp; <a href="https://github.com/ZhouFang92/Rao-Blackwell-method-for-cell-specific-model-identification"  target="_blank"> <small>Code2</small></a>] </h2>
      <p>Central to the analysis and inference of intracellular reaction systems is solving the Chemical Master Equation (CME), which characterizes the probability evolution of the randomly evolving copy-numbers of the reacting species. While conventional methods such as Monte-Carlo simulations and finite state projections exist for estimating CME solutions, they suffer from the curse of dimensionality, significantly decreasing their efficacy for high-dimensional systems. Here, we propose a new computational method that resolves this issue through a novel divide-and-conquer approach. Our method divides the system into a leader system and several conditionally independent follower subsystems. The solution of the CME is then constructed by combining Monte Carlo estimation for the leader system with stochastic filtering procedures for the follower subsystems. We develop an optimized system decomposition, which ensures the low-dimensionality of the sub-problems, thereby allowing for improved scalability with increasing system dimension. The efficiency and accuracy of the method are demonstrated through several biologically relevant examples in high-dimensional estimation and inference problems. We demonstrate that our method can successfully identify a yeast transcription system at the single-cell resolution, leveraging mRNA time-course microscopy data, allowing us to rigorously examine the heterogeneity in rate parameters among isogenic cells cultured under identical conditions. Furthermore, we validate this finding using a novel noise decomposition technique introduced in this study. This technique exploits experimental time-course data to quantify intrinsic and extrinsic noise components, without requiring supplementary components, such as dual-reporter systems. </p>
		<ul>
		<p>Z. Fang, A. Gupta, S. Kumar, M. Khammash, Advanced methods for gene network identification and noise decomposition from single-cell data. Nat Commun 15, 4911 (2024).</p>
	    <p>GitHub: https://github.com/ZhouFang92/Rao-Blackwellized-CME-solver  (for computing the CME only)</p>
		<p>GitHub: https://github.com/ZhouFang92/Rao-Blackwell-method-for-cell-specific-model-identification (for model identification)</p>
      </ul>
		
	</div>
		
	
		
	<div id="participants">
      <aside id="authorInfo"> 
        <!-- The author information is contained here -->
        <h2>Participants</h2>
        <p>The whole project was led by Prof. Mustafa Khammash and Dr. Ankit Gupta. Participants include Dr. Zhou Fang, Elena Sofia D'Ambrosio, and Nicolò Rossi.</p>
      </aside>
	</div>
    </section>
    <section id="sidebar"> 
      <!--************************************************************************
    Sidebar starts here. It contains a searchbox, sample ad image and 6 links
    ****************************************************************************-->
      <h2 style="color: gray;"">  <small>Contents</small>  </h2>
      <nav>
        <ul>
          <li><a href="#filtering" title="Link">Stochastic filtering for intracellular reaction processes</a></li>
          <li><a href="#project1" title="Link">1. Time-scale separation approach</a></li>
          <li><a href="#project2" title="Link">2. Regularized particle filter</a></li>
          <li><a href="#project3" title="Link">3. Filtered finite-state projection</a></li>
          <li><a href="#project4" title="Link">4. Divide-and-conquer approach</a></li>
		  <li><a href="#participants" title="Link">Participants</a></li>						 
        </ul>
      </nav>
    </section>
    <footer> 
      <!--************************************************************************
    Footer starts here
    ****************************************************************************-->
      <article>
        <h3>Prof. Mustafa Khammash</h3>
        <p>Mustafa Khammash is a full professor at the Department of Biosystems Science and Engineering (DBSSE), ETH Zurich. He leads the CTSB lab. </p>
      </article>
      <article>
        <h3>Dr. Ankit Gupta</h3>
        <p>Ankit Gupta is a permanent senior scientist at the Department of Biosystems Science and Engineering (DBSSE), ETH Zurich. He is a member in the CTSB lab </p>
      </article>
		<article>
        <h3>Dr. Zhou Fang</h3>
        <p>Zhou Fang was a postdoc researcher in the CTSB lab, at ETH Zurich. He is currently a tenure-track associate professor at the Chinese Academy of Sciences. </p>
      </article>
		</article>
		<article>
        <h3>Elena Sofia D'Ambrosio</h3>
        <p>Elena Sofia D'Ambrosio is a Ph.D. student in the CTSB lab, at ETH Zurich.</p>
      </article>
	  </article>
		<article>
        <h3>Nicolò Rossi</h3>
        <p>Nicolò Rossi is a Ph.D. student in the CTSB lab, at ETH Zurich.</p>
      </article>
    </footer>
  </div>
  <div id="footerbar"><!-- Small footerbar at the bottom --></div>
</div>
</body>
</html>
